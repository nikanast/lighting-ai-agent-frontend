<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Lighting AI Agent â€“ PDF Search</title>
</head>
<body>
  <h1>Lighting AI Agent</h1>

  <section>
    <h2>1. Upload Company</h2>
    <input type="text" id="companyName" placeholder="Company name" />
    <button id="saveCompanyBtn">Save Company</button>
  </section>

  <section>
    <h2>2. Upload PDF Catalog</h2>
    <input type="file" id="pdfFile" accept="application/pdf" />
    <button id="uploadPdfBtn">Upload PDF</button>
    <div id="uploadStatus"></div>
  </section>

  <section>
    <h2>3. Search Products by Specs</h2>
    <textarea id="searchSpecs" rows="4" cols="50"
      placeholder="Example: outdoor floodlight 100W 4000K IP65"></textarea>
    <button id="searchBtn">Search</button>
    <div id="searchResults"></div>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
    import { getStorage, ref, uploadBytes } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-storage.js";

    // ğŸ‘‰ Î’Î¬Î»Îµ ÎµÎ´Ï Ï„Î¿ firebaseConfig Î±Ï€ÏŒ Ï„Î¿ Firebase Console
    const firebaseConfig = {
      apiKey: "AIzaSyCNM9g155o24I6jv7TEBsPjqFjiO99MWZE",
      authDomain: "lighting-agent-platform.firebaseapp.com",
      projectId: "lighting-agent-platform",
      storageBucket: "lighting-agent-platform.firebasestorage.app",
      messagingSenderId: "503878688688",
      appId: "1:503878688688:web:aa8dce2ca869b058560075"
    };

    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    const pdfFileInput = document.getElementById('pdfFile');
    const uploadPdfBtn = document.getElementById('uploadPdfBtn');
    const uploadStatus = document.getElementById('uploadStatus');

    const searchBtn = document.getElementById('searchBtn');
    const searchSpecs = document.getElementById('searchSpecs');
    const searchResults = document.getElementById('searchResults');

    // 1) Upload PDF ÏƒÏ„Î¿ Firebase Storage (Î±ÏÎ³ÏŒÏ„ÎµÏÎ± Î¸Î± ÎºÎ±Î»ÎµÎ¯Ï‚ ÎºÎ±Î¹ N8N webhook)
    uploadPdfBtn.addEventListener('click', async () => {
      const file = pdfFileInput.files[0];
      if (!file) {
        uploadStatus.innerText = 'Î”Î¹Î¬Î»ÎµÎ¾Îµ Î­Î½Î± PDF Ï€ÏÏÏ„Î±.';
        return;
      }
      try {
        const storageRef = ref(storage, 'company-pdfs/' + file.name);
        await uploadBytes(storageRef, file);
        uploadStatus.innerText = 'Î¤Î¿ PDF Î±Î½Î­Î²Î·ÎºÎµ ÏƒÏ„Î¿ Storage. (Î•Ï€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±: call N8N)';
      } catch (err) {
        console.error(err);
        uploadStatus.innerText = 'Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ upload: ' + err.message;
      }
    });

    // 2) Search â€“ Î ÏÎ¿Ï‚ Ï„Î¿ Ï€Î±ÏÏŒÎ½ Î±Ï€Î»Î¬ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î¹ Î­Î³ÏÎ±ÏˆÎµÏ‚
    searchBtn.addEventListener('click', async () => {
      const specs = searchSpecs.value.trim();
      if (!specs) {
        searchResults.innerText = 'Î“ÏÎ¬ÏˆÎµ Ï„Î± specs Ï€Î¿Ï… ÏˆÎ¬Ï‡Î½ÎµÎ¹Ï‚.';
        return;
      }

      // Î‘ÏÎ³ÏŒÏ„ÎµÏÎ± ÎµÎ´Ï:
      // - Î˜Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ fetch ÏƒÎµ N8N webhook Î¼Îµ body { specs }
      // - Î˜Î± Ï€Î¬ÏÎµÎ¹Ï‚ Ï€Î¯ÏƒÏ‰ JSON Î¼Îµ products + rating
      // Î¤ÏÏÎ± placeholder:
      searchResults.innerText = 'Search requested for: ' + specs + ' (ÎµÎ´Ï Î¸Î± Î¼Ï€Î¿Ï…Î½ Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± Î±Ï€ÏŒ N8N).';
    });
  </script>
</body>
</html>
